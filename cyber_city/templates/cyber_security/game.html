
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber City Protection Squad - Game</title>
    
    <!-- Tailwind CSS with DaisyUI -->
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Modern Professional Theme Configuration -->
    <script>
        tailwind.config = {
            daisyui: {
                themes: [
                    {
                        modern: {
                            "primary": "#2563eb",        // Modern blue
                            "secondary": "#7c3aed",      // Modern purple
                            "accent": "#059669",         // Modern green
                            "neutral": "#374151",        // Refined gray
                            "base-100": "#ffffff",       // Pure white
                            "base-200": "#f9fafb",       // Subtle gray
                            "base-300": "#f3f4f6",       // Light gray
                            "info": "#0891b2",           // Cyan
                            "success": "#059669",        // Emerald
                            "warning": "#d97706",        // Orange
                            "error": "#dc2626",          // Red
                        },
                    },
                    "light",
                    "dark"
                ],
            },
        }
    </script>
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom CSS -->
    
    <link rel="stylesheet" href="/static/css/custom.css">
    
    <!-- Enhanced SEO Meta Tags -->
    <meta name="description" content="Transform learning into adventure with Decipherworld's game-based education platform. AI-powered tools for teachers, engaging learning for students, and collaborative group learning experiences.">
    <meta name="keywords" content="education, game-based learning, AI teaching tools, student engagement, EdTech, collaborative learning, climate education, STEM education, group learning platform">
    <meta name="author" content="DecipherWorld">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="">
    
    <!-- Open Graph Meta Tags for Social Sharing -->
    <meta property="og:title" content="">
    <meta property="og:description" content="Transform learning into adventure with game-based education, AI tools, and collaborative group learning experiences.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="">
    <meta property="og:site_name" content="DecipherWorld">
    <meta property="og:image" content=":///static/images/decipherworld-og-image.jpg">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@DecipherWorld">
    <meta name="twitter:title" content="">
    <meta name="twitter:description" content="Game-based education platform with AI tools and collaborative learning experiences.">
    <meta name="twitter:image" content=":///static/images/decipherworld-twitter-card.jpg">
    
    <!-- Educational Schema.org Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "EducationalOrganization",
        "name": "DecipherWorld",
        "description": "Game-based education platform transforming learning through AI tools and collaborative experiences",
        "url": "://",
        "logo": ":///static/images/decipherworld-logo.png",
        "sameAs": [
            "https://twitter.com/decipherworld",
            "https://linkedin.com/company/decipherworld"
        ],
        "contactPoint": {
            "@type": "ContactPoint",
            "telephone": "+1-XXX-XXX-XXXX",
            "contactType": "Customer Service",
            "availableLanguage": ["English"]
        },
        "address": {
            "@type": "PostalAddress",
            "addressCountry": "US"
        },
        "hasOfferCatalog": {
            "@type": "OfferCatalog",
            "name": "Educational Services",
            "itemListElement": [
                {
                    "@type": "OfferCatalog",
                    "name": "AI Learning Games",
                    "description": "Interactive AI-powered learning games for students"
                },
                {
                    "@type": "OfferCatalog", 
                    "name": "Group Learning Platform",
                    "description": "Collaborative scenario-based learning experiences"
                },
                {
                    "@type": "OfferCatalog",
                    "name": "Teacher AI Tools", 
                    "description": "AI-powered tools to enhance teaching effectiveness"
                }
            ]
        }
    }
    </script>
    
    <!-- Additional Structured Data for Educational Content -->
    
    
    <!-- Favicon and App Icons -->
    <link rel="icon" type="image/x-icon" href="/static/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/images/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/images/favicon-16x16.png">
    <link rel="manifest" href="/static/site.webmanifest">
    
    <!-- Performance and SEO Enhancements -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="//cdn.tailwindcss.com">
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
    
    <!-- Extra head content for child templates -->
    
</head>
<body data-theme="modern" class="bg-base-100">
    
    <!-- Mobile-First Navigation Header -->
    <div class="navbar bg-white shadow-lg border-b border-base-200 fixed top-0 z-50 backdrop-blur-sm min-h-16 px-2 sm:px-4 max-w-full">
        <div class="navbar-start">
            <!-- Mobile Menu -->
            <div class="dropdown">
                <div tabindex="0" role="button" class="btn btn-ghost btn-sm lg:hidden p-2">
                    <i class="fas fa-bars text-lg text-slate-700"></i>
                </div>
                <ul tabindex="0" class="menu menu-sm dropdown-content bg-white text-slate-700 rounded-lg z-[1] mt-3 w-56 p-3 shadow-xl border border-slate-200">
                    <li><a href="/" class="flex items-center gap-3 py-3 rounded-lg hover:bg-slate-50"><i class="fas fa-home text-primary"></i>Home</a></li>
                    <li><a href="/courses/" class="flex items-center gap-3 py-3 rounded-lg hover:bg-slate-50"><i class="fas fa-graduation-cap text-primary"></i>Student Courses</a></li>
                    <li>
                        <details>
                            <summary class="flex items-center gap-3 py-3 rounded-lg hover:bg-slate-50"><i class="fas fa-gamepad text-warning"></i>Educational Games<span class="badge badge-warning badge-xs ml-2">NEW</span></summary>
                            <ul class="p-2 bg-slate-50 rounded-md mt-2">
                                <li><a href="/games/" class="flex items-center gap-2 py-2 px-3 rounded hover:bg-white"><i class="fas fa-th-large text-warning"></i>Games Hub</a></li>
                                <li><a href="/games/ai-learning/" class="flex items-center gap-2 py-2 px-3 rounded hover:bg-white"><i class="fas fa-robot text-blue-500"></i>AI Learning</a></li>
                                <li><a href="/games/group-learning/" class="flex items-center gap-2 py-2 px-3 rounded hover:bg-white"><i class="fas fa-users text-green-500"></i>Group Learning</a></li>
                                <li><a href="/games/stem-challenges/" class="flex items-center gap-2 py-2 px-3 rounded hover:bg-white text-gray-400"><i class="fas fa-flask text-orange-400"></i>STEM Challenges<small class="ml-1">(Soon)</small></a></li>
                            </ul>
                        </details>
                    </li>
                    <li><a href="/teachers/" class="flex items-center gap-3 py-3 rounded-lg hover:bg-slate-50"><i class="fas fa-robot text-secondary"></i>AI for Teachers</a></li>
                    <li><a href="/schools/" class="flex items-center gap-3 py-3 rounded-lg hover:bg-slate-50"><i class="fas fa-building text-accent"></i>Schools</a></li>
                    <li><a href="/gallery/" class="flex items-center gap-3 py-3 rounded-lg hover:bg-slate-50"><i class="fas fa-images text-info"></i>Gallery</a></li>
                    <li><a href="/contact/" class="flex items-center gap-3 py-3 rounded-lg hover:bg-slate-50"><i class="fas fa-envelope text-success"></i>Get Started</a></li>
                </ul>
            </div>
            
            <!-- Professional Logo -->
            <a href="/" class="btn btn-ghost text-lg font-bold p-2 flex-none">
                <div class="flex items-center gap-2 lg:gap-3">
                    <div class="w-8 h-8 bg-gradient-to-br from-primary to-secondary rounded-lg flex items-center justify-center flex-shrink-0">
                        <i class="fas fa-atom text-white text-sm"></i>
                    </div>
                    <span class="text-neutral font-bold text-base sm:text-lg lg:text-xl whitespace-nowrap">
                        Decipherworld
                    </span>
                    <div class="badge badge-primary badge-xs hidden md:inline-flex ml-1">AI EdTech</div>
                </div>
            </a>
        </div>
        
        <!-- Desktop Navigation -->
        <div class="navbar-center hidden lg:flex">
            <ul class="menu menu-horizontal px-1 gap-2">
                <li>
                    <a href="/" class="btn btn-ghost btn-sm text-slate-700 hover:text-primary">
                        <i class="fas fa-home text-primary"></i>Home
                    </a>
                </li>
                <li>
                    <a href="/courses/" class="btn btn-ghost btn-sm text-slate-700 hover:text-primary">
                        <i class="fas fa-graduation-cap text-primary"></i>Students
                    </a>
                </li>
                <li>
                    <details>
                        <summary class="btn btn-ghost btn-sm text-slate-700 hover:text-warning">
                            <i class="fas fa-gamepad text-warning"></i>Games
                            <div class="badge badge-warning badge-xs">NEW</div>
                        </summary>
                        <ul class="p-2 bg-white shadow-lg rounded-lg border border-slate-200 w-48 z-50">
                            <li><a href="/games/" class="flex items-center gap-2 py-2 px-3 rounded hover:bg-slate-50"><i class="fas fa-th-large text-warning"></i>Games Hub</a></li>
                            <li><a href="/games/ai-learning/" class="flex items-center gap-2 py-2 px-3 rounded hover:bg-slate-50"><i class="fas fa-robot text-blue-500"></i>AI Learning</a></li>
                            <li><a href="/games/group-learning/" class="flex items-center gap-2 py-2 px-3 rounded hover:bg-slate-50"><i class="fas fa-users text-green-500"></i>Group Learning</a></li>
                            <li><a href="/games/stem-challenges/" class="flex items-center gap-2 py-2 px-3 rounded hover:bg-slate-50 text-gray-400"><i class="fas fa-flask text-orange-400"></i>STEM<small class="ml-1">(Soon)</small></a></li>
                        </ul>
                    </details>
                </li>
                <li>
                    <a href="/teachers/" class="btn btn-ghost btn-sm text-slate-700 hover:text-secondary">
                        <i class="fas fa-robot text-secondary"></i>Teachers
                        <div class="badge badge-secondary badge-xs">AI Training</div>
                    </a>
                </li>
                <li>
                    <a href="/schools/" class="btn btn-ghost btn-sm text-slate-700 hover:text-accent">
                        <i class="fas fa-building text-accent"></i>Schools
                    </a>
                </li>
                <li>
                    <a href="/gallery/" class="btn btn-ghost btn-sm text-slate-700 hover:text-info">
                        <i class="fas fa-images text-info"></i>Gallery
                    </a>
                </li>
            </ul>
        </div>
        
        <!-- Mobile CTA Button -->
        <div class="navbar-end">
            <a href="/contact/" class="btn btn-primary btn-sm shadow-lg hover:shadow-xl transition-all duration-300 px-3">
                <i class="fas fa-rocket text-sm"></i>
                <span class="hidden xs:inline text-sm">Get Started</span>
            </a>
        </div>
    </div>
    
    <!-- Main Content -->
    <main class="pt-16">
{% load static %}

<!-- Cyber City Game Styles -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
<style>
    body {
        background: linear-gradient(135deg, #0a0a23 0%, #1a1a3a 100%);
        font-family: 'Orbitron', monospace;
        color: #00ffff;
        overflow-x: hidden;
    }
    
    .cyber-grid {
        background-image: 
            linear-gradient(rgba(0, 255, 255, 0.1) 1px, transparent 1px),
            linear-gradient(90deg, rgba(0, 255, 255, 0.1) 1px, transparent 1px);
        background-size: 30px 30px;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        animation: gridMove 20s linear infinite;
    }
    
    @keyframes gridMove {
        0% { transform: translate(0, 0); }
        100% { transform: translate(30px, 30px); }
    }
    
    .cyber-hud {
        background: rgba(0, 0, 0, 0.9);
        border: 2px solid #00ffff;
        border-radius: 15px;
        box-shadow: 0 0 30px rgba(0, 255, 255, 0.3);
        backdrop-filter: blur(10px);
    }
    
    .mission-panel {
        background: linear-gradient(135deg, rgba(0, 0, 0, 0.8) 0%, rgba(26, 26, 58, 0.8) 100%);
        border: 1px solid #00ffff;
        border-radius: 10px;
        box-shadow: inset 0 0 20px rgba(0, 255, 255, 0.1);
    }
    
    .challenge-card {
        background: rgba(0, 0, 0, 0.7);
        border: 2px solid rgba(0, 255, 255, 0.3);
        border-radius: 10px;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .challenge-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.1), transparent);
        transition: left 0.5s;
    }
    
    .challenge-card:hover::before {
        left: 100%;
    }
    
    .challenge-card:hover {
        border-color: #00ffff;
        box-shadow: 0 0 20px rgba(0, 255, 255, 0.4);
        transform: scale(1.02);
    }
    
    .option-btn {
        background: rgba(0, 0, 0, 0.6);
        border: 2px solid rgba(0, 255, 255, 0.5);
        color: #00ffff;
        padding: 1rem;
        border-radius: 8px;
        transition: all 0.3s ease;
        cursor: pointer;
        text-align: left;
    }
    
    .option-btn:hover {
        border-color: #ff6b35;
        box-shadow: 0 0 15px rgba(255, 107, 53, 0.3);
        background: rgba(255, 107, 53, 0.1);
    }
    
    .option-btn.selected {
        border-color: #ff6b35;
        background: rgba(255, 107, 53, 0.2);
        box-shadow: 0 0 20px rgba(255, 107, 53, 0.4);
    }
    
    .cyber-btn {
        background: linear-gradient(45deg, #00ffff, #0080ff);
        border: none;
        color: #000;
        font-weight: bold;
        text-transform: uppercase;
        letter-spacing: 1px;
        padding: 0.75rem 1.5rem;
        border-radius: 8px;
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
    }
    
    .cyber-btn:hover {
        background: linear-gradient(45deg, #ff6b35, #ff8c42);
        transform: translateY(-2px);
        box-shadow: 0 10px 20px rgba(255, 107, 53, 0.3);
    }
    
    .progress-bar {
        background: rgba(0, 0, 0, 0.5);
        border-radius: 10px;
        overflow: hidden;
        border: 1px solid #00ffff;
    }
    
    .progress-fill {
        background: linear-gradient(90deg, #00ffff, #ff6b35);
        height: 20px;
        border-radius: 9px;
        transition: width 0.5s ease;
        box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
    }
    
    .tessa-dialogue {
        background: rgba(0, 255, 255, 0.1);
        border: 1px solid #00ffff;
        border-radius: 10px;
        position: relative;
    }
    
    .tessa-dialogue::before {
        content: '🤖';
        position: absolute;
        top: -10px;
        left: 15px;
        background: rgba(0, 0, 0, 0.8);
        padding: 0 10px;
        font-size: 1.2rem;
        border: 1px solid #00ffff;
        border-radius: 50%;
    }
    
    .badge-unlock {
        animation: badgeUnlock 1s ease-out;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 1000;
        background: rgba(0, 0, 0, 0.9);
        border: 2px solid #ff6b35;
        border-radius: 15px;
        padding: 2rem;
        text-align: center;
    }
    
    @keyframes badgeUnlock {
        0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
        50% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
        100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
    }
    
    .city-security-meter {
        background: radial-gradient(circle, rgba(0, 255, 255, 0.1) 0%, transparent 70%);
        border: 2px solid #00ffff;
        border-radius: 50%;
        width: 120px;
        height: 120px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
    }
    
    .city-security-meter::before {
        content: '';
        position: absolute;
        top: -5px;
        left: -5px;
        right: -5px;
        bottom: -5px;
        border: 2px solid transparent;
        border-radius: 50%;
        background: conic-gradient(from 0deg, #00ffff, #ff6b35, #00ffff);
        mask: radial-gradient(farthest-side, transparent calc(100% - 4px), white calc(100% - 4px));
        animation: rotate 3s linear infinite;
    }
    
    @keyframes rotate {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
</style>

<div class="cyber-grid"></div>

<div class="min-h-screen relative z-10">
    <!-- Game Header HUD -->
    <div class="cyber-hud mx-4 mt-4 p-6">
        <div class="flex flex-wrap items-center justify-between gap-4">
            <div class="flex items-center space-x-4">
                <div class="text-3xl">🛡️</div>
                <div>
                    <h1 class="text-2xl font-bold text-cyan-400">CYBER CITY PROTECTION SQUAD</h1>
                    <p class="text-cyan-300">Mission 1: Password Fortress</p>
                </div>
            </div>
            
            {% if player %}
            <div class="flex items-center space-x-6">
                <!-- Player Info -->
                <div class="text-center">
                    <div class="text-2xl mb-1">
                        {% if player.suit_style == 'neon_knight' %}⚔️
                        {% elif player.suit_style == 'pixel_guard' %}🛡️
                        {% else %}👾{% endif %}
                    </div>
                    <div class="text-cyan-300 font-bold">{{ player.hero_nickname }}</div>
                    <div class="text-cyan-500 text-sm">{{ player.get_suit_style_display }}</div>
                </div>
                
                <!-- Progress -->
                <div class="text-center">
                    <div class="text-cyan-400 font-bold">Score</div>
                    <div class="text-2xl text-orange-400">{{ player.total_score }}</div>
                </div>
                
                <!-- City Security Level -->
                <div class="city-security-meter">
                    <div class="text-center">
                        <div class="text-cyan-400 font-bold text-sm">SECURITY</div>
                        <div class="text-xl text-orange-400">{{ session.city_security_level }}%</div>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>

    <div class="container mx-auto px-4 py-6">
        {% if session.mission_stage == 'intro' %}
        <!-- Mission Introduction -->
        <div class="max-w-4xl mx-auto">
            <div class="mission-panel p-8 text-center">
                <h2 class="text-4xl font-bold text-cyan-400 mb-6">🏙️ WELCOME TO CYBER CITY</h2>
                
                <div class="tessa-dialogue p-6 mb-8">
                    <div class="text-lg text-cyan-300">
                        <strong class="text-orange-400">Captain Tessa:</strong> 
                        "Greetings, defender! Our city's digital infrastructure is under attack. 
                        The Password Fortress has been compromised, and we need your expertise to secure it. 
                        Are you ready to join the Cyber City Protection Squad?"
                    </div>
                </div>
                
                <div class="grid md:grid-cols-3 gap-6 mb-8">
                    <div class="challenge-card p-6">
                        <div class="text-3xl mb-3">🔐</div>
                        <h3 class="text-cyan-400 font-bold mb-2">5 Security Challenges</h3>
                        <p class="text-cyan-300 text-sm">Test your password security knowledge</p>
                    </div>
                    
                    <div class="challenge-card p-6">
                        <div class="text-3xl mb-3">🏆</div>
                        <h3 class="text-cyan-400 font-bold mb-2">Earn Cyber Badges</h3>
                        <p class="text-cyan-300 text-sm">Unlock achievements for your heroic deeds</p>
                    </div>
                    
                    <div class="challenge-card p-6">
                        <div class="text-3xl mb-3">🏙️</div>
                        <h3 class="text-cyan-400 font-bold mb-2">Protect the City</h3>
                        <p class="text-cyan-300 text-sm">Increase city security level to 100%</p>
                    </div>
                </div>
                
                {% if not player %}
                <a href="{% url 'cyber_city:avatar' session.session_code %}" class="cyber-btn">
                    🚀 CREATE YOUR DEFENDER
                </a>
                {% else %}
                <button onclick="startMission()" class="cyber-btn">
                    ⚡ BEGIN MISSION
                </button>
                {% endif %}
            </div>
        </div>
        
        {% elif session.mission_stage == 'mission_brief' %}
        <!-- Mission Briefing -->
        <div class="max-w-4xl mx-auto">
            <div class="mission-panel p-8">
                <h2 class="text-3xl font-bold text-cyan-400 mb-6 text-center">📋 MISSION BRIEFING</h2>
                
                <div class="tessa-dialogue p-6 mb-6">
                    <div class="text-lg text-cyan-300">
                        <strong class="text-orange-400">Captain Tessa:</strong> 
                        "Excellent, {{ player.hero_nickname }}! Your suit looks impressive. 
                        Now, let me brief you on the Password Fortress situation. 
                        We've detected 5 critical vulnerabilities in our password security systems. 
                        Your mission is to identify and neutralize each threat."
                    </div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-6 mb-6">
                    <div class="challenge-card p-6">
                        <h3 class="text-cyan-400 font-bold mb-4">🎯 Mission Objectives</h3>
                        <ul class="text-cyan-300 space-y-2">
                            <li>• Complete 5 cybersecurity challenges</li>
                            <li>• Learn password security best practices</li>
                            <li>• Earn cyber badges for achievements</li>
                            <li>• Restore city security to 100%</li>
                        </ul>
                    </div>
                    
                    <div class="challenge-card p-6">
                        <h3 class="text-cyan-400 font-bold mb-4">🛡️ Your Equipment</h3>
                        <ul class="text-cyan-300 space-y-2">
                            <li>• {{ player.get_suit_style_display }} armor</li>
                            <li>• AI-powered guidance system</li>
                            <li>• Real-time threat analysis</li>
                            <li>• Badge collection system</li>
                        </ul>
                    </div>
                </div>
                
                <div class="text-center">
                    <button onclick="startMission()" class="cyber-btn">
                        ⚡ START MISSION
                    </button>
                </div>
            </div>
        </div>
        
        {% elif session.mission_stage == 'in_progress' %}
        <!-- Active Mission -->
        <div class="max-w-6xl mx-auto">
            <!-- Progress Bar -->
            <div class="mission-panel p-6 mb-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl font-bold text-cyan-400">Mission Progress</h3>
                    <div class="text-cyan-300">Challenge {{ player.current_challenge }} of 5</div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" style="width: {{ progress_percentage }}%"></div>
                </div>
                <div class="flex justify-between text-sm text-cyan-500 mt-2">
                    <span>0%</span>
                    <span>{{ progress_percentage }}% Complete</span>
                    <span>100%</span>
                </div>
            </div>
            
            {% if current_challenge %}
            <!-- Current Challenge -->
            <div class="grid lg:grid-cols-3 gap-6">
                <!-- Challenge Panel -->
                <div class="lg:col-span-2">
                    <div class="challenge-card p-8">
                        <div class="flex items-center justify-between mb-6">
                            <h2 class="text-2xl font-bold text-cyan-400">
                                🔐 {{ current_challenge.title }}
                            </h2>
                            <div class="text-orange-400 font-bold">
                                Challenge {{ current_challenge.challenge_number }}
                            </div>
                        </div>
                        
                        <div class="text-cyan-300 text-lg mb-8 leading-relaxed">
                            {{ current_challenge.question_text }}
                        </div>
                        
                        <!-- Options -->
                        <div class="space-y-4 mb-8">
                            <div class="option-btn" onclick="selectOption('A')">
                                <div class="flex items-center space-x-3">
                                    <div class="w-8 h-8 bg-cyan-600 rounded-full flex items-center justify-center font-bold">A</div>
                                    <div>{{ current_challenge.option_a }}</div>
                                </div>
                            </div>
                            
                            <div class="option-btn" onclick="selectOption('B')">
                                <div class="flex items-center space-x-3">
                                    <div class="w-8 h-8 bg-cyan-600 rounded-full flex items-center justify-center font-bold">B</div>
                                    <div>{{ current_challenge.option_b }}</div>
                                </div>
                            </div>
                            
                            <div class="option-btn" onclick="selectOption('C')">
                                <div class="flex items-center space-x-3">
                                    <div class="w-8 h-8 bg-cyan-600 rounded-full flex items-center justify-center font-bold">C</div>
                                    <div>{{ current_challenge.option_c }}</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="text-center">
                            <button onclick="submitAnswer()" class="cyber-btn" id="submitBtn" disabled>
                                SUBMIT ANSWER
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Side Panel -->
                <div class="space-y-6">
                    <!-- Captain Tessa -->
                    <div class="tessa-dialogue p-6">
                        <div class="text-cyan-300">
                            <strong class="text-orange-400">Captain Tessa:</strong><br>
                            "Take your time, {{ player.hero_nickname }}. Analyze each option carefully. 
                            The city's security depends on your knowledge!"
                        </div>
                    </div>
                    
                    <!-- Badges Earned -->
                    {% if player.badges_earned %}
                    <div class="challenge-card p-6">
                        <h3 class="text-cyan-400 font-bold mb-4">🏆 Badges Earned</h3>
                        <div class="space-y-2">
                            {% for badge in player.badges_earned %}
                            <div class="flex items-center space-x-2 text-cyan-300">
                                {% if badge == 'perfect_defender' %}
                                    <span>🛡️ Perfect Defender</span>
                                {% elif badge == 'cyber_speedster' %}
                                    <span>⚡ Cyber Speedster</span>
                                {% elif badge == 'password_master' %}
                                    <span>🔐 Password Master</span>
                                {% endif %}
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                    
                    <!-- Stats -->
                    <div class="challenge-card p-6">
                        <h3 class="text-cyan-400 font-bold mb-4">📊 Stats</h3>
                        <div class="space-y-3 text-cyan-300">
                            <div class="flex justify-between">
                                <span>Correct Answers:</span>
                                <span class="text-green-400">{{ player.correct_answers }}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Wrong Answers:</span>
                                <span class="text-red-400">{{ player.wrong_answers }}</span>
                            </div>
                            <div class="flex justify-between">
                                <span>Total Score:</span>
                                <span class="text-orange-400">{{ player.total_score }}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
        
        {% elif session.mission_stage == 'completed' %}
        <!-- Mission Complete -->
        <div class="max-w-4xl mx-auto">
            <div class="mission-panel p-8 text-center">
                <h2 class="text-4xl font-bold text-green-400 mb-6">🎉 MISSION ACCOMPLISHED!</h2>
                
                <div class="tessa-dialogue p-6 mb-8">
                    <div class="text-lg text-cyan-300">
                        <strong class="text-orange-400">Captain Tessa:</strong> 
                        "Outstanding work, {{ player.hero_nickname }}! You've successfully secured the Password Fortress. 
                        The city's digital infrastructure is now protected thanks to your expertise. 
                        You are truly a hero of Cyber City!"
                    </div>
                </div>
                
                <div class="grid md:grid-cols-3 gap-6 mb-8">
                    <div class="challenge-card p-6">
                        <div class="text-3xl mb-3 text-green-400">🏆</div>
                        <h3 class="text-cyan-400 font-bold mb-2">Final Score</h3>
                        <p class="text-orange-400 text-2xl font-bold">{{ player.total_score }}</p>
                    </div>
                    
                    <div class="challenge-card p-6">
                        <div class="text-3xl mb-3 text-blue-400">🛡️</div>
                        <h3 class="text-cyan-400 font-bold mb-2">Challenges Complete</h3>
                        <p class="text-green-400 text-2xl font-bold">{{ player.challenges_completed }}/5</p>
                    </div>
                    
                    <div class="challenge-card p-6">
                        <div class="text-3xl mb-3 text-purple-400">🔐</div>
                        <h3 class="text-cyan-400 font-bold mb-2">City Security</h3>
                        <p class="text-green-400 text-2xl font-bold">{{ session.city_security_level }}%</p>
                    </div>
                </div>
                
                {% if player.badges_earned %}
                <div class="challenge-card p-6 mb-8">
                    <h3 class="text-cyan-400 font-bold mb-4">🏆 Your Cyber Badges</h3>
                    <div class="flex flex-wrap justify-center gap-4">
                        {% for badge in player.badges_earned %}
                        <div class="bg-gradient-to-r from-cyan-500 to-orange-500 p-3 rounded-lg">
                            {% if badge == 'perfect_defender' %}
                                <span class="text-white font-bold">🛡️ Perfect Defender</span>
                            {% elif badge == 'cyber_speedster' %}
                                <span class="text-white font-bold">⚡ Cyber Speedster</span>
                            {% elif badge == 'password_master' %}
                                <span class="text-white font-bold">🔐 Password Master</span>
                            {% endif %}
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
                
                <div class="space-x-4">
                    <button onclick="window.location.reload()" class="cyber-btn">
                        🔄 PLAY AGAIN
                    </button>
                    <a href="/games/" class="cyber-btn">
                        🎮 MORE GAMES
                    </a>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</div>

<script>
// Game State
let selectedAnswer = null;
let currentChallengeId = {{ current_challenge.id|default:"null" }};
let sessionCode = '{{ session.session_code }}';

function selectOption(option) {
    // Remove previous selection
    document.querySelectorAll('.option-btn').forEach(btn => {
        btn.classList.remove('selected');
    });
    
    // Select new option
    event.currentTarget.classList.add('selected');
    selectedAnswer = option;
    
    // Enable submit button
    document.getElementById('submitBtn').disabled = false;
}

function startMission() {
    // Start the mission
    fetch(`/cyber-city/${sessionCode}/action/`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        },
        body: JSON.stringify({
            action_type: 'start_mission'
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.action_result === 'mission_started') {
            window.location.reload();
        }
    })
    .catch(error => console.error('Error:', error));
}

function submitAnswer() {
    if (!selectedAnswer) return;
    
    // Disable submit button
    document.getElementById('submitBtn').disabled = true;
    
    // Submit answer
    fetch(`/cyber-city/${sessionCode}/action/`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': getCookie('csrftoken')
        },
        body: JSON.stringify({
            action_type: 'submit_answer',
            challenge_id: currentChallengeId,
            answer: selectedAnswer,
            time_taken: 30
        })
    })
    .then(response => response.json())
    .then(data => {
        showResult(data);
    })
    .catch(error => {
        console.error('Error:', error);
        document.getElementById('submitBtn').disabled = false;
    });
}

function showResult(data) {
    // Create result overlay
    const overlay = document.createElement('div');
    overlay.className = 'fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50';
    
    overlay.innerHTML = `
        <div class="challenge-card p-8 max-w-lg mx-4 text-center">
            <div class="text-6xl mb-4">
                ${data.is_correct ? '✅' : '❌'}
            </div>
            <h3 class="text-2xl font-bold mb-4 ${data.is_correct ? 'text-green-400' : 'text-red-400'}">
                ${data.is_correct ? 'CORRECT!' : 'INCORRECT'}
            </h3>
            <div class="text-cyan-300 mb-4">
                Points Earned: <span class="text-orange-400 font-bold">${data.points_earned}</span>
            </div>
            <div class="text-cyan-300 mb-6 text-left">
                <strong>Explanation:</strong><br>
                ${data.explanation}
            </div>
            ${data.tessa_tip ? `
                <div class="tessa-dialogue p-4 mb-6 text-left">
                    <strong class="text-orange-400">Captain Tessa:</strong><br>
                    ${data.tessa_tip}
                </div>
            ` : ''}
            ${data.badges_earned && data.badges_earned.length > 0 ? `
                <div class="mb-6">
                    <h4 class="text-cyan-400 font-bold mb-2">🏆 New Badge Unlocked!</h4>
                    <div class="bg-gradient-to-r from-cyan-500 to-orange-500 p-3 rounded-lg">
                        <span class="text-white font-bold">${data.badges_earned[0]}</span>
                    </div>
                </div>
            ` : ''}
            <button onclick="continueGame(${data.mission_complete})" class="cyber-btn">
                ${data.mission_complete ? '🎉 VIEW RESULTS' : '➡️ CONTINUE'}
            </button>
        </div>
    `;
    
    document.body.appendChild(overlay);
}

function continueGame(missionComplete) {
    // Remove overlay and reload page
    document.querySelector('.fixed.inset-0').remove();
    window.location.reload();
}

function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

// Initialize game
document.addEventListener('DOMContentLoaded', function() {
    console.log('Cyber City Protection Squad initialized');
});
</script>

    </main>
    
    <!-- Mobile-Optimized Footer -->
    <footer class="footer footer-center bg-gradient-to-t from-slate-100 to-slate-50 text-slate-700 p-6 sm:p-10">
        <div class="grid grid-flow-col gap-4">
            <div class="grid grid-flow-col gap-4">
                <!-- Mobile-Optimized Company Info -->
                <div class="text-center">
                    <div class="flex items-center justify-center gap-2 mb-3 sm:mb-4">
                        <div class="text-2xl sm:text-3xl">🤖</div>
                        <span class="text-xl sm:text-2xl font-bold text-slate-800">
                            Decipherworld
                        </span>
                    </div>
                    <p class="text-sm sm:text-base text-slate-600 max-w-md mx-auto mb-3 sm:mb-4 px-2">
                        World's first game and team-based AI learning platform. 
                        Transforming education for students and empowering teachers with 5X productivity.
                    </p>
                    <div class="flex flex-wrap justify-center gap-1 sm:gap-2 mb-3 sm:mb-4">
                        <div class="badge badge-primary badge-xs sm:badge-sm">500+ Schools</div>
                        <div class="badge badge-secondary badge-xs sm:badge-sm">AI Powered</div>
                        <div class="badge badge-accent badge-xs sm:badge-sm">Game-Based</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Quick Links -->
        <div class="grid grid-flow-col gap-8">
            <div>
                <span class="footer-title text-primary">Students</span> 
                <a href="/courses/" class="link link-hover flex items-center gap-1">
                    <i class="fas fa-robot text-xs"></i>AI Courses
                </a>
                <a href="/courses/" class="link link-hover flex items-center gap-1">
                    <i class="fas fa-coins text-xs"></i>Financial Literacy
                </a>
            </div>
            <div>
                <span class="footer-title text-secondary">Teachers</span> 
                <a href="/teachers/" class="link link-hover flex items-center gap-1">
                    <i class="fas fa-chalkboard-teacher text-xs"></i>AI Training
                </a>
                <a href="/teachers/" class="link link-hover flex items-center gap-1">
                    <i class="fas fa-handshake text-xs"></i>Classroom Support
                </a>
            </div>
            <div>
                <span class="footer-title text-accent">Connect</span> 
                <a href="/contact/" class="link link-hover flex items-center gap-1">
                    <i class="fas fa-rocket text-xs"></i>Get Started
                </a>
                <a href="/gallery/" class="link link-hover flex items-center gap-1">
                    <i class="fas fa-images text-xs"></i>Success Stories
                </a>
                <a href="mailto:customerservice@decipherworld.com" class="link link-hover flex items-center gap-1">
                    <i class="fas fa-envelope text-xs"></i>Contact Us
                </a>
            </div>
        </div>
        
        <!-- Social Links -->
        <div>
            <div class="grid grid-flow-col gap-4">
                <a href="#" class="btn btn-circle btn-outline btn-sm" title="LinkedIn">
                    <i class="fab fa-linkedin-in"></i>
                </a>
                <a href="#" class="btn btn-circle btn-outline btn-sm" title="Twitter">
                    <i class="fab fa-twitter"></i>
                </a>
                <a href="#" class="btn btn-circle btn-outline btn-sm" title="YouTube">
                    <i class="fab fa-youtube"></i>
                </a>
                <a href="#" class="btn btn-circle btn-outline btn-sm" title="Instagram">
                    <i class="fab fa-instagram"></i>
                </a>
            </div>
        </div>
        
        <!-- Copyright -->
        <div class="border-t border-base-300 pt-6 w-full text-center">
            <p class="text-base-content/60">
                &copy; 2025 Decipherworld. All rights reserved. | 
                <span class="text-primary font-semibold">Making Education Engaging & Effective</span> ⚡
            </p>
        </div>
    </footer>
    
    <!-- Theme Toggle Script (Optional) -->
    <script>
        // Optional: Add theme toggle functionality
        function toggleTheme() {
            const theme = document.documentElement.getAttribute('data-theme');
            const newTheme = theme === 'light' ? 'dark' : 'light';
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
        }
        
        // Load saved theme
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
    </script>
    
    
    
</body>
</html>